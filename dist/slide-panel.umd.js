(function(d,n){typeof exports=="object"&&typeof module<"u"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(d=typeof globalThis<"u"?globalThis:d||self,n(d.SlidePanel={},d.Vue))})(this,function(d,n){"use strict";const b=n.defineComponent({__name:"SlideDeck",props:{align:{type:String,default:"right",validator:e=>["left","right"].indexOf(e)>-1},backdrop:Boolean},setup(e){const t=e;function r(a,...p){return a.reduce((g,y)=>g.then(()=>y(...p)),Promise.resolve())}const i=n.ref(!1);n.ref(!1);const s=n.reactive({zIndex:0,panels:[],get topSlide(){return this.panels.find(a=>a.isTopSlide)}}),o=n.computed(()=>({[`slide-${t.align}`]:!0,"has-slide-top":s.panels.reduce((a,p)=>a||p.isTopSlide,!1)})),l=n.computed(()=>({left:t.align==="left",right:t.align==="right"}));n.computed(()=>s.panels[s.panels.length-1]);const c=n.computed(()=>({display:i.value?void 0:"none",zIndex:s.zIndex===0?-1:1}));n.watch(()=>s.zIndex,a=>{i.value=a>0}),n.onMounted(()=>{window.addEventListener("keyup",({code:a})=>{a==="Escape"&&s.panels.length&&s.panels[s.panels.length-1].close()})});function f(){const a=[...s.panels].reverse().map((p,g)=>()=>new Promise(y=>{p.close(S=>(S!==!1&&setTimeout(()=>{y(S)},Math.max(100,p.duration/(s.panels.length-g))),S))}));r(a)}return n.provide("align",t.align),n.provide("registry",s),(a,p)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["slide-deck-panel-wrapper",n.unref(l)]),style:n.normalizeStyle({display:i.value?void 0:"none"})},[e.backdrop?(n.openBlock(),n.createElementBlock("div",{key:0,class:"slide-deck-panel-backdrop",onClick:f})):n.createCommentVNode("",!0),n.createElementVNode("div",{ref:"panel",class:n.normalizeClass(["slide-deck-panel",n.unref(o)]),style:n.normalizeStyle(n.unref(c))},[n.renderSlot(a.$slots,"default")],6)],6))}}),J="";var u={px:{px:1,cm:96/2.54,mm:96/25.4,in:96,pt:96/72,pc:16},cm:{px:2.54/96,cm:1,mm:.1,in:2.54,pt:2.54/72,pc:2.54/6},mm:{px:25.4/96,cm:10,mm:1,in:25.4,pt:25.4/72,pc:25.4/6},in:{px:1/96,cm:1/2.54,mm:1/25.4,in:1,pt:1/72,pc:1/6},pt:{px:.75,cm:72/2.54,mm:72/25.4,in:72,pt:1,pc:12},pc:{px:6/96,cm:6/2.54,mm:6/25.4,in:6,pt:6/72,pc:1},deg:{deg:1,grad:.9,rad:180/Math.PI,turn:360},grad:{deg:400/360,grad:1,rad:200/Math.PI,turn:400},rad:{deg:Math.PI/180,grad:Math.PI/200,rad:1,turn:Math.PI*2},turn:{deg:1/360,grad:1/400,rad:.5/Math.PI,turn:1},s:{s:1,ms:1/1e3},ms:{s:1e3,ms:1},Hz:{Hz:1,kHz:1e3},kHz:{Hz:1/1e3,kHz:1},dpi:{dpi:1,dpcm:1/2.54,dppx:1/96},dpcm:{dpi:2.54,dpcm:1,dppx:2.54/96},dppx:{dpi:96,dpcm:96/2.54,dppx:1}},M=function(e,t,r,i){if(!u.hasOwnProperty(r))throw new Error("Cannot convert to "+r);if(!u[r].hasOwnProperty(t))throw new Error("Cannot convert from "+t+" to "+r);var s=u[r][t]*e;return i!==!1?(i=Math.pow(10,parseInt(i)||5),Math.round(s*i)/i):s};const Q="",w=(e,t)=>{const r=e.__vccOpts||e;for(const[i,s]of t)r[i]=s;return r};function k(e,...t){return e.reduce((r,i)=>r.then(()=>i(...t)),Promise.resolve())}const O={inject:["align","registry"],props:{show:Boolean,width:{type:String,default:"33%"}},data(){return{isDisplaying:!1,isHover:!1,isShowing:!1,isTopSlide:!1,translateX:0,zIndex:-1}},computed:{classes(){return{show:this.isShowing,"slide-top":!!this.isTopSlide}},duration(){return getComputedStyle(this.$refs.content).transitionDuration.split(",").map(e=>{const[t,r,i]=e.trim().match(/^([\d.]+)(\w+)$/);return M(parseFloat(r),i,"ms")}).sort((e,t)=>e-t).shift()},styles(){const e=this.align==="left"?1:-1,t=this.registry.panels.length-1-this.registry.panels.indexOf(this);return{zIndex:this.isDisplaying?this.zIndex:-1,display:this.isDisplaying?"flex":"none",transform:this.isShowing&&`translateX(calc((${e} * ${t} * 3.5rem) - (${e*-1} * ${this.isHover&&!this.isTopSlide?"3.5rem":"0rem"})))`}}},watch:{isShowing(e){const t=this.registry.panels.indexOf(this);e?(this.isDisplaying=!0,this.zIndex=++this.registry.zIndex,this.registry.panels.push(this)):this.registry.panels.splice(t,1)},isDisplaying(e){e?this.$emit("open",this):this.registry.panels.length||(this.registry.zIndex=0)},show(e){e?this.open():this.close()}},mounted(){this.show&&setTimeout(()=>this.open(),1),this.$watch(()=>this.registry.panels,()=>{const e=this.registry.panels.indexOf(this);this.isTopSlide=e>-1&&e+1===this.registry.panels.length},{deep:!0})},methods:{close(e){const t=new Event("close",{cancelable:!0});return new Promise(r=>{setTimeout(()=>{this.$emit("close",t,r),t.defaultPrevented||r(!0)})}).then(r=>(typeof e=="function"&&(r=e(r)),this.isShowing=r===!1)),this},divide(e,t){const r=e.toString().match(/^(\d+)(.+)$/);return r[0]?`${parseInt(r[1])/t}${r[2]}`:e},open(){return this.isShowing=!0,this},toggle(){return this.isShowing?this.close():this.open(),this},translatePosition(){},x(){return this.$el&&this.$el.getBoundingClientRect().x},y(){return this.$el&&this.$el.getBoundingClientRect().y},onBeforeEnter(){this.$emit("before-enter",this)},onEnterFrom(){this.$emit("enter-from",this)},onAfterEnter(){this.$emit("after-enter",this)},onBeforeLeave(){this.$emit("before-leave",this)},onLeaveFrom(){this.$emit("leave-from",this)},onAfterLeave(){this.isDisplaying=this.isShowing,this.$emit("after-leave",this)},onClick(e){if(this.$refs.close){const t=this.registry.panels.indexOf(this),r=this.registry.panels.slice(t+1),i=r.reverse().map((s,o)=>()=>new Promise(l=>{s.close(c=>(c!==!1&&setTimeout(()=>{l(c)},Math.max(100,this.duration/(r.length-o))),c))}));k(i)}},onClickClose(){this.close()},onMouseenter(e){this.isTopSlide||this.registry.panels.slice(0,this.registry.panels.indexOf(this)+1).forEach(t=>{t.isHover=!0})},onMouseleave(e){this.registry.panels.slice(0,this.registry.panels.indexOf(this)+1).forEach(t=>{t.isHover=!1})}}},C={ref:"inner",class:"slide-panel-content-inner"},B=[n.createElementVNode("span",null,"\xD7",-1)];function A(e,t,r,i,s,o){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["slide-panel",o.classes]),style:n.normalizeStyle(o.styles),onMouseenter:t[2]||(t[2]=n.withModifiers((...l)=>o.onMouseenter&&o.onMouseenter(...l),["self"])),onMouseleave:t[3]||(t[3]=n.withModifiers((...l)=>o.onMouseleave&&o.onMouseleave(...l),["self"]))},[n.createVNode(n.Transition,{name:"slide",onBeforeEnter:o.onBeforeEnter,onEnterFrom:o.onEnterFrom,onAfterEnter:o.onAfterEnter,onBeforeLeave:o.onBeforeLeave,onLeaveFrom:o.onLeaveFrom,onAfterLeave:o.onAfterLeave},{default:n.withCtx(()=>[s.isShowing?(n.openBlock(),n.createElementBlock("div",{key:0,ref:"content",class:"slide-panel-content",onClick:t[1]||(t[1]=(...l)=>o.onClick&&o.onClick(...l))},[n.createElementVNode("div",C,[n.renderSlot(e.$slots,"default")],512),n.createElementVNode("div",null,[n.createElementVNode("a",{ref:"close",href:"#",class:"slide-panel-close",onClick:t[0]||(t[0]=n.withModifiers((...l)=>o.close&&o.close(...l),["prevent"]))},B,512)])],512)):n.createCommentVNode("",!0)]),_:3},8,["onBeforeEnter","onEnterFrom","onAfterEnter","onBeforeLeave","onLeaveFrom","onAfterLeave"])],38)}const x=w(O,[["render",A]]),I={components:{SlideDeck:b,SlidePanel:x},props:{options:Object,panels:Array,removePanel:Function},methods:{getPanelChildren(e){const t=this.$refs.panel[this.panels.indexOf(e)];return e.callback.apply(t,[t])},onAfterLeave(e){e.resolve(),this.removePanel(e)}}};function j(e,t,r,i,s,o){const l=n.resolveComponent("SlidePanel"),c=n.resolveComponent("SlideDeck");return n.openBlock(),n.createBlock(c,n.normalizeProps(n.guardReactiveProps(r.options)),{default:n.withCtx(()=>[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.panels,f=>(n.openBlock(),n.createBlock(l,n.mergeProps({key:f.id,ref_for:!0,ref:"panel",show:!0},f.options,{onAfterLeave:()=>o.onAfterLeave(f)}),{default:n.withCtx(()=>[(n.openBlock(),n.createBlock(n.resolveDynamicComponent(o.getPanelChildren(f))))]),_:2},1040,["onAfterLeave"]))),128))]),_:1},16)}const z=w(I,[["render",j]]);class T{constructor(t){this.app=t}mount(t){t.appContext=this.app._context;const r=document.createElement("div");n.render(n.h(t),r),document.body.append(r)}register(t,r={}){let i=-1;const s=n.reactive([]);function o(l){s.splice(s.findIndex(c=>c.id===l.id),1)}this[t]=(l,c={})=>new Promise(f=>{s.push({callback:l,options:c,resolve:f,id:++i,showing:!0})}).finally(()=>{}),this.mount(n.h(z,{options:r,panels:s,removePanel:o}))}}var $=function(t){return L(t)&&!D(t)};function L(e){return!!e&&typeof e=="object"}function D(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||N(e)}var v=typeof Symbol=="function"&&Symbol.for,F=v?Symbol.for("react.element"):60103;function N(e){return e.$$typeof===F}function H(e){return Array.isArray(e)?[]:{}}function m(e,t){return t.clone!==!1&&t.isMergeableObject(e)?h(H(e),e,t):e}function V(e,t,r){return e.concat(t).map(function(i){return m(i,r)})}function R(e,t){if(!t.customMerge)return h;var r=t.customMerge(e);return typeof r=="function"?r:h}function X(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function _(e){return Object.keys(e).concat(X(e))}function P(e,t){try{return t in e}catch{return!1}}function q(e,t){return P(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function K(e,t,r){var i={};return r.isMergeableObject(e)&&_(e).forEach(function(s){i[s]=m(e[s],r)}),_(t).forEach(function(s){q(e,s)||(P(e,s)&&r.isMergeableObject(t[s])?i[s]=R(s,r)(e[s],t[s],r):i[s]=m(t[s],r))}),i}function h(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||V,r.isMergeableObject=r.isMergeableObject||$,r.cloneUnlessOtherwiseSpecified=m;var i=Array.isArray(t),s=Array.isArray(e),o=i===s;return o?i?r.arrayMerge(e,t,r):K(e,t,r):m(t,r)}h.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(i,s){return h(i,s,r)},{})};var Y=h,E=Y;const G=(e,t={})=>{const r=new T(e);r.register("right",E({align:"right"},{})),r.register("left",E({align:"left"},{})),e.provide("slidePanel",r),e.config.globalProperties.$slidePanel=r};d.SlideDeck=b,d.SlidePanel=x,d.SlidePanelPlugin=G,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
